{"version":3,"file":"js/74.ba9ccb33.js","mappings":"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","sources":["webpack://wisdom_park_visitor/./src/views/visitor/visitorApproval.vue?dbdd","webpack://wisdom_park_visitor/./src/views/visitor/visitorApproval.vue?96c9","webpack://wisdom_park_visitor/./src/views/visitor/visitorApproval.vue","webpack://wisdom_park_visitor/src/views/visitor/visitorApproval.vue"],"sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"visitor-approval\"},[_c('van-sticky',{attrs:{\"offset-top\":0.00000001}},[_c('van-nav-bar',{attrs:{\"title\":\"访客审批\",\"left-arrow\":\"\"},on:{\"click-left\":_vm.onClickLeft}})],1),_c('van-pull-refresh',{on:{\"refresh\":_vm.onRefresh},model:{value:(_vm.refreshing),callback:function ($$v) {_vm.refreshing=$$v},expression:\"refreshing\"}},[(this.data.length == 0)?_c('van-empty',{staticStyle:{\"height\":\"80vh\"},attrs:{\"description\":\"没有需要审批的数据\"}}):_c('van-list',{staticStyle:{\"min-height\":\"calc(100vh - 46px)\"},attrs:{\"finished\":_vm.finished,\"finished-text\":\"没有更多了\"},on:{\"load\":_vm.onLoad},model:{value:(_vm.loading),callback:function ($$v) {_vm.loading=$$v},expression:\"loading\"}},_vm._l((_vm.data),function(item,i){return _c('div',{key:i,staticClass:\"custom-list\",on:{\"click\":function($event){return _vm.handleDetail(i)}}},[_c('span',[_vm._v(_vm._s(item.addTime))]),_c('van-swipe-cell',{scopedSlots:_vm._u([{key:\"right\",fn:function(){return [_c('van-button',{attrs:{\"square\":\"\",\"type\":\"primary\",\"text\":\"同意\"},on:{\"click\":function($event){return _vm.handleApproval(item, 'YYTY')}}}),_c('van-button',{attrs:{\"square\":\"\",\"type\":\"danger\",\"text\":\"拒绝\"},on:{\"click\":function($event){return _vm.handleDecline(item, 'YYBTY')}}})]},proxy:true}],null,true)},[_c('van-cell',{attrs:{\"size\":\"large\"},scopedSlots:_vm._u([{key:\"title\",fn:function(){return [_c('div',{staticClass:\"title\"},[_c('van-image',{attrs:{\"round\":\"\",\"fit\":\"cover\",\"src\":item.picData ||\n                    require('../../assets/image/home/default-touxiang.png'),\"alt\":\"图片加载失败\"},on:{\"click\":function($event){_vm.ImageView(\n                      item.picData ||\n                        require('../../assets/image/home/default-touxiang.png')\n                    )}}}),_c('span',[_vm._v(\" \"+_vm._s(item.visitorName)+\" \")])],1)]},proxy:true},{key:\"label\",fn:function(){return [_c('div',{staticClass:\"custom-title-detail\"},[_c('div',[_c('span',[_vm._v(\"手机号码：\")]),_c('span',[_vm._v(_vm._s(item.visitorPhoneNbr))])]),_c('div',[_c('span',[_vm._v(\"访问时间：\")]),_c('span',[_vm._v(_vm._s(item.visitStartTime)+\" - \"+_vm._s(item.visitEndTime))])]),_c('div',{class:{\n                    'show-detail': true,\n                    'set-height': _vm.detailKeyList.includes(i)\n                  }},[_c('van-divider',{style:({\n                      color: '#4b92d9',\n                      borderColor: '#5a9ee3',\n                      margin: '8px 0'\n                    }),attrs:{\"dashed\":\"\",\"content-position\":\"left\"}},[_vm._v(\"详细信息\")]),(item.visitorReason)?_c('div',{staticClass:\"van-ellipsis\"},[_c('span',[_vm._v(\"访问事由：\")]),_c('span',[_vm._v(_vm._s(item.visitorReason)+\" \")])]):_vm._e(),(item.voucherTypeName)?_c('div',[_c('span',[_vm._v(\"证件类型：\")]),_c('span',[_vm._v(_vm._s(item.voucherTypeName))])]):_vm._e(),(item.voucherCode)?_c('div',[_c('span',[_vm._v(\"证件号码：\")]),_c('span',[_vm._v(_vm._s(item.voucherCode))])]):_vm._e(),(item.visitSexName)?_c('div',[_c('span',[_vm._v(\"访客性别：\")]),_c('span',[_vm._v(_vm._s(item.visitSexName))])]):_vm._e(),(item.plate)?_c('div',[_c('span',[_vm._v(\"车牌号码：\")]),_c('span',[_vm._v(_vm._s(item.plate))])]):_vm._e(),(item.carryArticle)?_c('div',[_c('span',[_vm._v(\"携带物品：\")]),_c('span',[_vm._v(_vm._s(item.carryArticle))])]):_vm._e(),(item.remark)?_c('div',{staticClass:\"van-ellipsis\",on:{\"click\":function($event){$event.stopPropagation();return _vm.$toast({\n                        duration: 0,\n                        overlay: true,\n                        closeOnClick: true,\n                        message: item.remark,\n                        className: 'toast-left',\n                        closeOnClickOverlay: true\n                      })}}},[_c('span',[_vm._v(\"备注：\")]),_c('span',[_vm._v(_vm._s(item.remark))])]):_vm._e()],1)])]},proxy:true},{key:\"default\",fn:function(){return [_c('span',{class:item.sts},[_c('i'),_vm._v(\" \"+_vm._s(_vm.visitorStsList[item.sts])+\" \")])]},proxy:true}],null,true)})],1)],1)}),0)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./visitorApproval.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./visitorApproval.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./visitorApproval.vue?vue&type=template&id=f387460a&\"\nimport script from \"./visitorApproval.vue?vue&type=script&lang=js&\"\nexport * from \"./visitorApproval.vue?vue&type=script&lang=js&\"\nimport style0 from \"./visitorApproval.vue?vue&type=style&index=0&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","\r\n\r\n<template>\r\n  <div class=\"visitor-approval\">\r\n    <van-sticky :offset-top=\"0.00000001\">\r\n      <van-nav-bar title=\"访客审批\" left-arrow @click-left=\"onClickLeft\" />\r\n    </van-sticky>\r\n    <!-- 主页面 -->\r\n    <van-pull-refresh v-model=\"refreshing\" @refresh=\"onRefresh\">\r\n      <van-empty\r\n        v-if=\"this.data.length == 0\"\r\n        description=\"没有需要审批的数据\"\r\n        style=\"height: 80vh\"\r\n      />\r\n      <van-list\r\n        v-else\r\n        @load=\"onLoad\"\r\n        v-model=\"loading\"\r\n        :finished=\"finished\"\r\n        finished-text=\"没有更多了\"\r\n        style=\"min-height: calc(100vh - 46px)\"\r\n      >\r\n        <div\r\n          class=\"custom-list\"\r\n          v-for=\"(item, i) in data\"\r\n          :key=\"i\"\r\n          @click=\"handleDetail(i)\"\r\n        >\r\n          <span>{{ item.addTime }}</span>\r\n          <van-swipe-cell>\r\n            <van-cell size=\"large\">\r\n              <!-- 自定义标题 -->\r\n              <template #title>\r\n                <div class=\"title\">\r\n                  <van-image\r\n                    round\r\n                    fit=\"cover\"\r\n                    :src=\"\r\n                      item.picData ||\r\n                      require('../../assets/image/home/default-touxiang.png')\r\n                    \"\r\n                    @click=\"\r\n                      ImageView(\r\n                        item.picData ||\r\n                          require('../../assets/image/home/default-touxiang.png')\r\n                      )\r\n                    \"\r\n                    alt=\"图片加载失败\"\r\n                  />\r\n                  <span>\r\n                    {{ item.visitorName }}\r\n                  </span>\r\n                </div>\r\n              </template>\r\n              <!-- 自定义主要内容 -->\r\n              <template #label>\r\n                <div class=\"custom-title-detail\">\r\n                  <div>\r\n                    <span>手机号码：</span>\r\n                    <span>{{ item.visitorPhoneNbr }}</span>\r\n                  </div>\r\n                  <div>\r\n                    <span>访问时间：</span>\r\n                    <span\r\n                      >{{ item.visitStartTime }} - {{ item.visitEndTime }}</span\r\n                    >\r\n                  </div>\r\n                  <div\r\n                    :class=\"{\r\n                      'show-detail': true,\r\n                      'set-height': detailKeyList.includes(i)\r\n                    }\"\r\n                  >\r\n                    <van-divider\r\n                      dashed\r\n                      content-position=\"left\"\r\n                      :style=\"{\r\n                        color: '#4b92d9',\r\n                        borderColor: '#5a9ee3',\r\n                        margin: '8px 0'\r\n                      }\"\r\n                      >详细信息</van-divider\r\n                    >\r\n                    <div v-if=\"item.visitorReason\" class=\"van-ellipsis\">\r\n                      <span>访问事由：</span>\r\n                      <span>{{ item.visitorReason }} </span>\r\n                    </div>\r\n                    <div v-if=\"item.voucherTypeName\">\r\n                      <span>证件类型：</span>\r\n                      <span>{{ item.voucherTypeName }}</span>\r\n                    </div>\r\n                    <div v-if=\"item.voucherCode\">\r\n                      <span>证件号码：</span>\r\n                      <span>{{ item.voucherCode }}</span>\r\n                    </div>\r\n                    <div v-if=\"item.visitSexName\">\r\n                      <span>访客性别：</span>\r\n                      <span>{{ item.visitSexName }}</span>\r\n                    </div>\r\n                    <div v-if=\"item.plate\">\r\n                      <span>车牌号码：</span>\r\n                      <span>{{ item.plate }}</span>\r\n                    </div>\r\n                    <div v-if=\"item.carryArticle\">\r\n                      <span>携带物品：</span>\r\n                      <span>{{ item.carryArticle }}</span>\r\n                    </div>\r\n                    <div\r\n                      v-if=\"item.remark\"\r\n                      @click.stop=\"\r\n                        $toast({\r\n                          duration: 0,\r\n                          overlay: true,\r\n                          closeOnClick: true,\r\n                          message: item.remark,\r\n                          className: 'toast-left',\r\n                          closeOnClickOverlay: true\r\n                        })\r\n                      \"\r\n                      class=\"van-ellipsis\"\r\n                    >\r\n                      <span>备注：</span>\r\n                      <span>{{ item.remark }}</span>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </template>\r\n              <!-- 自定义右侧内容 -->\r\n              <template #default>\r\n                <span :class=\"item.sts\">\r\n                  <i />\r\n                  {{ visitorStsList[item.sts] }}\r\n                </span>\r\n              </template>\r\n            </van-cell>\r\n            <template #right>\r\n              <van-button\r\n                square\r\n                type=\"primary\"\r\n                text=\"同意\"\r\n                @click=\"handleApproval(item, 'YYTY')\"\r\n              />\r\n              <van-button\r\n                square\r\n                type=\"danger\"\r\n                text=\"拒绝\"\r\n                @click=\"handleDecline(item, 'YYBTY')\"\r\n              />\r\n            </template>\r\n          </van-swipe-cell>\r\n        </div>\r\n      </van-list>\r\n    </van-pull-refresh>\r\n  </div>\r\n</template>\r\n<script>\r\nimport { qryVisitorInfoList, addVisitorStepInfo } from '@/api/visitor' // 获取通行码\r\nimport { mapState } from 'vuex'\r\nimport { ImagePreview } from 'vant'\r\nexport default {\r\n  name: 'visitorApproval',\r\n  data() {\r\n    return {\r\n      data: [],\r\n      loading: false,\r\n      finished: false,\r\n      refreshing: false,\r\n      page: {\r\n        page: 1,\r\n        size: 8\r\n      },\r\n      visitorStsList: {\r\n        YYZ: '预约中',\r\n        YYTY: '预约同意',\r\n        YYBTY: '未同意'\r\n      }, //状态列表\r\n      detailKeyList: []\r\n    }\r\n  },\r\n  methods: {\r\n    async init() {\r\n      this.onRefresh()\r\n    },\r\n    ImageView(img) {\r\n      ImagePreview([img])\r\n    },\r\n    onClickLeft() {\r\n      this.$router.back(-1)\r\n    },\r\n    handleDetail(i) {\r\n      const arr = this.detailKeyList\r\n      if (arr.includes(i)) {\r\n        this.detailKeyList = arr.filter((item) => item !== i)\r\n      } else {\r\n        this.detailKeyList.push(i)\r\n      }\r\n    },\r\n    onLoad() {\r\n      qryVisitorInfoList({\r\n        visitType: '3',\r\n        sts: 'YYZ',\r\n        // toOpenid: this.myUserInfo.openId,\r\n        phoneNbr: this.myUserInfo.phoneNbr,\r\n        pageNo: this.page.page,\r\n        pageSize: this.page.size\r\n      }).then((res) => {\r\n        this.loading = false\r\n        if (res.code === 200) {\r\n          this.page.page += 1\r\n          if (this.refreshing) {\r\n            this.data = []\r\n            this.refreshing = false\r\n          }\r\n          this.data = this.data.concat(\r\n            res.data.row.map((item) => {\r\n              const obj = eval('(' + item.visitorPersonArr + ')')[0]\r\n              obj.picData = obj.picData && obj.picData.replace(/ /g, '+')\r\n              return {\r\n                ...item,\r\n                ...obj,\r\n                visitStartTime: this.$util.format(\r\n                  new Date(item.visitStartTime.replace(/-/g, '/')),\r\n                  'yyyy-MM-dd hh:mm'\r\n                ),\r\n                visitEndTime: this.$util.format(\r\n                  new Date(item.visitEndTime.replace(/-/g, '/')),\r\n                  'yyyy-MM-dd hh:mm'\r\n                )\r\n              }\r\n            })\r\n          )\r\n          if (this.data.length === res.data.total) {\r\n            this.finished = true\r\n          }\r\n        } else {\r\n          this.$toast.fail({\r\n            message: res.msg\r\n          })\r\n        }\r\n      })\r\n    },\r\n    onRefresh() {\r\n      // 清空列表数据\r\n      this.finished = false\r\n      // 重新加载数据\r\n      // 将 loading 设置为 true，表示处于加载状态\r\n      this.loading = true\r\n      this.page.page = 1\r\n      this.onLoad()\r\n    },\r\n    // 点击拒绝\r\n    handleDecline(item, sts) {\r\n      this.$dialog\r\n        .confirm({\r\n          title: `您确认拒绝${item.visitorName}访问吗？`\r\n        })\r\n        .then(() => {\r\n          this.handleApproval(item, sts)\r\n        })\r\n        .catch(() => {\r\n          // on cancel\r\n        })\r\n    },\r\n    handleApproval(item, sts) {\r\n      this.$toast.loading({\r\n        duration: 0,\r\n        message: '数据审批中...'\r\n      })\r\n      addVisitorStepInfo({\r\n        //被访人用户信息\r\n        unitId: this.unitId,\r\n        visitorInfoId: item.visitorInfoId,\r\n        handleOpenid: this.myUserInfo.openId,\r\n        phoneNbr: this.myUserInfo.phoneNbr,\r\n        handleDt: new Date(),\r\n        handleRemark: this.visitorStsList[sts],\r\n        visitorSts: item.sts,\r\n        sts\r\n      }).then((res) => {\r\n        this.$toast.clear()\r\n        if (res.code === 200) {\r\n          item.sts = sts\r\n          item.visitorStsName = this.visitorStsList[sts]\r\n          this.$toast.success({\r\n            message: res.msg\r\n          })\r\n        } else {\r\n          this.$toast.fail({\r\n            message: res.msg\r\n          })\r\n        }\r\n      })\r\n    }\r\n  },\r\n  created() {\r\n    this.init()\r\n  },\r\n  computed: mapState({\r\n    myUserInfo: (state) => state.user.userInfo,\r\n    unitId: (state) => state.user.unitId\r\n  })\r\n}\r\n</script>\r\n\r\n<style lang=\"less\">\r\n.visitor-approval {\r\n  div.custom-list {\r\n    padding: 11px 8px 0;\r\n    text-align: right;\r\n    position: relative;\r\n    transition: height 0.3s ease-in-out;\r\n    > span {\r\n      font-size: 10px;\r\n      position: absolute;\r\n      right: 20px;\r\n      bottom: -5px;\r\n      color: #b1a8a8;\r\n    }\r\n    > div {\r\n      box-shadow: 0 0 10px -7px #d5d5d5;\r\n      .van-cell {\r\n        border-radius: 6px;\r\n        .van-cell__title {\r\n          flex: inherit;\r\n          text-align: left;\r\n          max-width: 275px;\r\n          > div.title {\r\n            display: flex;\r\n            align-items: center;\r\n            > .van-image {\r\n              width: 25px;\r\n              height: 25px;\r\n            }\r\n            i {\r\n              font-size: 17px;\r\n            }\r\n            > span {\r\n              margin-left: 5px;\r\n              font-size: 14px;\r\n              font-weight: 550;\r\n              color: #525256;\r\n            }\r\n          }\r\n        }\r\n        .van-cell__label {\r\n          margin: 10px 0 5px;\r\n          line-height: 20px;\r\n          .custom-title-detail > div {\r\n            span {\r\n              white-space: nowrap;\r\n              &:first-child {\r\n                display: inline-block;\r\n                width: 60px;\r\n              }\r\n            }\r\n            &.show-detail {\r\n              .van-ellipsis {\r\n                width: 100%;\r\n                max-width: inherit;\r\n              }\r\n              display: block;\r\n              transition: height 0.3s ease-in-out;\r\n              height: 0;\r\n              overflow: hidden;\r\n            }\r\n            &.set-height {\r\n              height: 180px;\r\n            }\r\n            display: flex;\r\n            align-items: center;\r\n            font-size: 12px;\r\n          }\r\n        }\r\n        .van-cell__value {\r\n          span {\r\n            font-size: 10px;\r\n            width: 100%;\r\n            white-space: nowrap;\r\n            i {\r\n              display: inline-block;\r\n              width: 5px;\r\n              height: 5px;\r\n              background: #666;\r\n              border-radius: 50%;\r\n            }\r\n          }\r\n          span.YYTY {\r\n            color: #07c160;\r\n            i {\r\n              background: #07c160;\r\n            }\r\n          }\r\n          span.YYZ {\r\n            color: #ffaf60;\r\n            i {\r\n              background: #ffaf60;\r\n            }\r\n          }\r\n          span.YYBTY {\r\n            color: #ee0a24;\r\n            i {\r\n              background: #ee0a24;\r\n            }\r\n          }\r\n        }\r\n      }\r\n      .van-swipe-cell__right {\r\n        right: -1px;\r\n        button:last-child {\r\n          border-top-right-radius: 6px;\r\n          border-bottom-right-radius: 6px;\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n\r\n"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","on","onClickLeft","onRefresh","model","value","callback","$$v","refreshing","expression","data","length","staticStyle","finished","onLoad","loading","_l","item","i","key","$event","handleDetail","_v","_s","addTime","scopedSlots","_u","fn","handleApproval","handleDecline","proxy","picData","ImageView","visitorName","visitorPhoneNbr","visitStartTime","visitEndTime","class","detailKeyList","includes","style","color","borderColor","margin","visitorReason","_e","voucherTypeName","voucherCode","visitSexName","plate","carryArticle","stopPropagation","$toast","duration","overlay","closeOnClick","message","remark","className","closeOnClickOverlay","sts","visitorStsList","staticRenderFns","component","name","page","size","YYZ","YYTY","YYBTY","methods","async","img","$router","back","arr","filter","push","visitType","phoneNbr","myUserInfo","pageNo","pageSize","res","code","concat","total","fail","msg","$dialog","unitId","visitorInfoId","handleOpenid","openId","handleDt","Date","handleRemark","visitorSts","clear","visitorStsName","success","created","init","computed"],"sourceRoot":""}