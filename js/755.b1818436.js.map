{"version":3,"file":"js/755.b1818436.js","mappings":"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","sources":["webpack://wisdom_park_visitor/./src/views/visitor/visitorLog.vue?8df6","webpack://wisdom_park_visitor/./src/views/visitor/visitorLog.vue?10ae","webpack://wisdom_park_visitor/./src/views/visitor/visitorLog.vue","webpack://wisdom_park_visitor/src/views/visitor/visitorLog.vue"],"sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"visitor-log\"},[_c('van-sticky',{attrs:{\"offset-top\":0.00000001}},[_c('van-nav-bar',{attrs:{\"title\":\"访客记录\",\"left-arrow\":\"\"},on:{\"click-left\":_vm.onClickLeft}})],1),_c('van-pull-refresh',{on:{\"refresh\":_vm.onRefresh},model:{value:(_vm.refreshing),callback:function ($$v) {_vm.refreshing=$$v},expression:\"refreshing\"}},[(this.data.length == 0)?_c('van-empty',{staticStyle:{\"height\":\"80vh\"},attrs:{\"description\":\"当前无访客\"}}):_c('van-list',{staticStyle:{\"min-height\":\"calc(100vh - 46px)\"},attrs:{\"finished\":_vm.finished,\"finished-text\":\"没有更多了\"},on:{\"load\":_vm.onLoad},model:{value:(_vm.loading),callback:function ($$v) {_vm.loading=$$v},expression:\"loading\"}},_vm._l((_vm.data),function(item,i){return _c('div',{key:i,staticClass:\"custom-list\",on:{\"click\":function($event){return _vm.handleQuery(item)}}},[_c('van-swipe-cell',{scopedSlots:_vm._u([{key:\"right\",fn:function(){return [_c('van-button',{attrs:{\"square\":\"\",\"type\":\"danger\",\"text\":\"删除\"},on:{\"click\":function($event){return _vm.handleDel(item, i)}}})]},proxy:true}],null,true)},[_c('van-cell',{attrs:{\"size\":\"large\"},scopedSlots:_vm._u([{key:\"title\",fn:function(){return [_c('div',{staticClass:\"title\"},[_c('van-icon',{staticClass:\"iconfont\",attrs:{\"class-prefix\":\"icon\",\"name\":item.visitType == 1 ? 'VIPfangke' : 'linshifangke'}}),_c('span',[_vm._v(_vm._s({ 1: '贵宾访客', 3: '临时访客' }[item.visitType]))])],1)]},proxy:true},{key:\"label\",fn:function(){return [_c('div',{staticClass:\"custom-title-detail\"},[_c('div',[_c('span',[_vm._v(\"访客姓名：\")]),_c('span',{staticClass:\"van-ellipsis\"},[_vm._v(\" \"+_vm._s(item.visitorName))])]),_c('div',[_c('span',[_vm._v(\"访问时间：\")]),_c('span',[_vm._v(_vm._s(item.visitStartTime)+\" - \"+_vm._s(item.visitEndTime))])])])]},proxy:true},{key:\"default\",fn:function(){return [_c('span',{class:item.sts},[_c('i'),_vm._v(\" \"+_vm._s(_vm.visitorStsList[item.sts])+\" \")])]},proxy:true}],null,true)})],1)],1)}),0)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./visitorLog.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./visitorLog.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./visitorLog.vue?vue&type=template&id=3d066990&\"\nimport script from \"./visitorLog.vue?vue&type=script&lang=js&\"\nexport * from \"./visitorLog.vue?vue&type=script&lang=js&\"\nimport style0 from \"./visitorLog.vue?vue&type=style&index=0&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","\r\n\r\n<template>\r\n  <div class=\"visitor-log\">\r\n    <van-sticky :offset-top=\"0.00000001\">\r\n      <van-nav-bar title=\"访客记录\" left-arrow @click-left=\"onClickLeft\" />\r\n    </van-sticky>\r\n    <!-- 主页面 -->\r\n    <van-pull-refresh v-model=\"refreshing\" @refresh=\"onRefresh\">\r\n      <van-empty\r\n        v-if=\"this.data.length == 0\"\r\n        description=\"当前无访客\"\r\n        style=\"height: 80vh\"\r\n      />\r\n      <van-list\r\n        v-else\r\n        @load=\"onLoad\"\r\n        v-model=\"loading\"\r\n        :finished=\"finished\"\r\n        finished-text=\"没有更多了\"\r\n        style=\"min-height: calc(100vh - 46px)\"\r\n      >\r\n        <div\r\n          class=\"custom-list\"\r\n          v-for=\"(item, i) in data\"\r\n          :key=\"i\"\r\n          @click=\"handleQuery(item)\"\r\n        >\r\n          <van-swipe-cell>\r\n            <van-cell size=\"large\">\r\n              <!-- 自定义标题 -->\r\n              <template #title>\r\n                <div class=\"title\">\r\n                  <van-icon\r\n                    class=\"iconfont\"\r\n                    class-prefix=\"icon\"\r\n                    :name=\"item.visitType == 1 ? 'VIPfangke' : 'linshifangke'\"\r\n                  />\r\n                  <span>{{\r\n                    { 1: '贵宾访客', 3: '临时访客' }[item.visitType]\r\n                  }}</span>\r\n                </div>\r\n              </template>\r\n              <!-- 自定义主要内容 -->\r\n              <template #label>\r\n                <div class=\"custom-title-detail\">\r\n                  <div>\r\n                    <span>访客姓名：</span>\r\n                    <span class=\"van-ellipsis\"> {{ item.visitorName }}</span>\r\n                  </div>\r\n                  <div>\r\n                    <span>访问时间：</span>\r\n                    <span\r\n                      >{{ item.visitStartTime }} - {{ item.visitEndTime }}</span\r\n                    >\r\n                  </div>\r\n                </div>\r\n              </template>\r\n              <template #default>\r\n                <span :class=\"item.sts\">\r\n                  <i />\r\n                  {{ visitorStsList[item.sts] }}\r\n                </span>\r\n              </template>\r\n            </van-cell>\r\n            <template #right>\r\n              <van-button\r\n                square\r\n                type=\"danger\"\r\n                text=\"删除\"\r\n                @click=\"handleDel(item, i)\"\r\n              />\r\n            </template>\r\n          </van-swipe-cell>\r\n        </div>\r\n      </van-list>\r\n    </van-pull-refresh>\r\n  </div>\r\n</template>\r\n<script>\r\nimport { mapState } from 'vuex'\r\nimport { qryVisitorInfoList, deleteVisitorInfo } from '@/api/visitor' // 获取访客记录\r\nexport default {\r\n  name: 'VisitorLog',\r\n  data() {\r\n    return {\r\n      data: [],\r\n      loading: false,\r\n      finished: false,\r\n      refreshing: false,\r\n      page: {\r\n        page: 1,\r\n        size: 8\r\n      },\r\n      visitorStsList: {\r\n        YYZ: '预约中',\r\n        YYTY: '预约同意',\r\n        YYBTY: '未同意',\r\n        YDF: '已到访',\r\n        YLK: '已离开',\r\n        JJTX: '拒绝通行'\r\n      } //状态列表\r\n    }\r\n  },\r\n  methods: {\r\n    onClickLeft() {\r\n      this.$router.back(-1)\r\n    },\r\n    handleQuery(item) {\r\n      // 查看访客记录\r\n      //预约中才可以修改\r\n      const disabled = !['YYZ', 'YYTY'].includes(item.sts)\r\n      if (item.sts !== 'YYZ') {\r\n        this.$toast({\r\n          duration: 3000,\r\n          message: '该访客预约单状态并非【预约中】，不可进行操作'\r\n        })\r\n      }\r\n      switch (item.visitType) {\r\n        case '1':\r\n          this.$router.push({\r\n            name: 'VIPappointment',\r\n            params: { disabled, vipVisitId: item.visitorInfoId }\r\n          })\r\n          break\r\n        case '3':\r\n          this.$router.push({\r\n            name: 'temporaryVisitorReg',\r\n            params: {\r\n              disabled,\r\n              isToOpenId: true,\r\n              temporaryVisitId: item.visitorInfoId\r\n            }\r\n          })\r\n          break\r\n        default:\r\n          this.$toast({\r\n            message: '数据失效'\r\n          })\r\n          break\r\n      }\r\n    },\r\n    handleDel(item, i) {\r\n      this.$dialog\r\n        .confirm({\r\n          title: '请确认是否删除此条信息？'\r\n        })\r\n        .then(() => {\r\n          deleteVisitorInfo({\r\n            visitorInfoId: item.visitorInfoId,\r\n            createName: this.myUserInfo.name\r\n          }).then((res) => {\r\n            if (res.code === 200) {\r\n              this.$toast({\r\n                message: res.msg\r\n              })\r\n              this.data.splice(i, 1)\r\n            } else {\r\n              this.$toast({\r\n                message: res.msg\r\n              })\r\n            }\r\n          })\r\n        })\r\n        .catch(() => {\r\n          // on cancel\r\n        })\r\n    },\r\n    onLoad() {\r\n      // 获取访客记录一览\r\n      qryVisitorInfoList({\r\n        // toOpenid: this.myUserInfo.openId,\r\n        phoneNbr: this.myUserInfo.phoneNbr,\r\n        pageNo: this.page.page,\r\n        pageSize: this.page.size\r\n      })\r\n        .then((res) => {\r\n          this.loading = false\r\n          if (res.code === 200) {\r\n            this.page.page += 1\r\n            if (this.refreshing) {\r\n              this.data = []\r\n              this.refreshing = false\r\n            }\r\n            this.data = this.data.concat(\r\n              res.data.row.map((item) => {\r\n                return {\r\n                  ...item,\r\n                  visitStartTime: this.$util.format(\r\n                    new Date(item.visitStartTime.replace(/-/g, '/')),\r\n                    'yyyy-MM-dd hh:mm'\r\n                  ),\r\n                  visitEndTime: this.$util.format(\r\n                    new Date(item.visitEndTime.replace(/-/g, '/')),\r\n                    'yyyy-MM-dd hh:mm'\r\n                  ),\r\n                  visitorName: String(\r\n                    eval('(' + item.visitorPersonArr + ')').map(\r\n                      (item1) => item1.visitorName\r\n                    )\r\n                  )\r\n                }\r\n              })\r\n            )\r\n            if (this.data.length === res.data.total) {\r\n              this.finished = true\r\n            }\r\n          } else {\r\n            this.$toast.fail({\r\n              message: res.msg\r\n            })\r\n          }\r\n        })\r\n        .catch(() => {\r\n          this.loading = false\r\n        })\r\n    },\r\n    onRefresh() {\r\n      this.finished = false\r\n      // 重新加载数据\r\n      // 将 loading 设置为 true，表示处于加载状态\r\n      this.loading = true\r\n      this.page.page = 1\r\n      this.onLoad()\r\n    }\r\n  },\r\n  async created() {\r\n    this.onRefresh()\r\n  },\r\n  computed: mapState({\r\n    myUserInfo: (state) => state.user.userInfo\r\n  })\r\n}\r\n</script>\r\n\r\n<style lang=\"less\">\r\n.visitor-log {\r\n  div.custom-list {\r\n    padding: 11px 8px 0;\r\n    text-align: right;\r\n    position: relative;\r\n    transition: height 0.3s ease-in-out;\r\n    > div {\r\n      box-shadow: 0 0 10px -7px #d5d5d5;\r\n      .van-cell {\r\n        border-radius: 6px;\r\n        .van-cell__title {\r\n          flex: inherit;\r\n          text-align: left;\r\n          max-width: 275px;\r\n          > div.title {\r\n            display: flex;\r\n            align-items: center;\r\n            i {\r\n              font-size: 17px;\r\n              &.icon-richangfangke {\r\n                margin-left: -2.3px;\r\n                margin-right: -6px;\r\n              }\r\n            }\r\n            > span {\r\n              margin-left: 3px;\r\n              font-size: 14px;\r\n              font-weight: 550;\r\n              color: #525256;\r\n            }\r\n          }\r\n        }\r\n        .van-cell__label {\r\n          margin: 10px 0 5px;\r\n          line-height: 20px;\r\n          .custom-title-detail > div {\r\n            span {\r\n              white-space: nowrap;\r\n              &:first-child {\r\n                display: inline-block;\r\n                width: 60px;\r\n              }\r\n            }\r\n            display: flex;\r\n            align-items: center;\r\n            font-size: 12px;\r\n          }\r\n        }\r\n        .van-cell__value {\r\n          span {\r\n            font-size: 10px;\r\n            width: 100%;\r\n            white-space: nowrap;\r\n            i {\r\n              display: inline-block;\r\n              width: 5px;\r\n              height: 5px;\r\n              background: #666;\r\n              border-radius: 50%;\r\n            }\r\n          }\r\n          span.YYTY {\r\n            color: #07c160;\r\n            i {\r\n              background: #07c160;\r\n            }\r\n          }\r\n          span.YYZ {\r\n            color: #ffaf60;\r\n            i {\r\n              background: #ffaf60;\r\n            }\r\n          }\r\n          span.YYBTY {\r\n            color: #ee0a24;\r\n            i {\r\n              background: #ee0a24;\r\n            }\r\n          }\r\n          span.YDF {\r\n            color: #ebd671;\r\n            i {\r\n              background: #ebd671;\r\n            }\r\n          }\r\n          span.YLK {\r\n            color: #5ee6eb;\r\n            i {\r\n              background: #5ee6eb;\r\n            }\r\n          }\r\n          span.JJTY {\r\n            color: #f473b9;\r\n            i {\r\n              background: #f473b9;\r\n            }\r\n          }\r\n        }\r\n      }\r\n      .van-swipe-cell__right {\r\n        right: -1px;\r\n        button:last-child {\r\n          border-top-right-radius: 6px;\r\n          border-bottom-right-radius: 6px;\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n\r\n"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","on","onClickLeft","onRefresh","model","value","callback","$$v","refreshing","expression","data","length","staticStyle","finished","onLoad","loading","_l","item","i","key","$event","handleQuery","scopedSlots","_u","fn","handleDel","proxy","visitType","_v","_s","visitorName","visitStartTime","visitEndTime","class","sts","visitorStsList","staticRenderFns","component","name","page","size","YYZ","YYTY","YYBTY","YDF","YLK","JJTX","methods","$router","back","disabled","includes","$toast","duration","message","push","params","isToOpenId","temporaryVisitId","visitorInfoId","$dialog","phoneNbr","myUserInfo","pageNo","pageSize","async","computed"],"sourceRoot":""}