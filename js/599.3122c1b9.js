"use strict";(self["webpackChunkwisdom_park_pe"]=self["webpackChunkwisdom_park_pe"]||[]).push([[599],{4599:function(e,s,a){a.r(s),a.d(s,{default:function(){return c}});var t=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"personalCenter"},[t("van-sticky",{attrs:{"offset-top":1e-8}},[t("div",{staticClass:"detail-top"},[t("van-image",{attrs:{width:"100%",fit:"fill",src:a(879),alt:"图片加载失败"}}),t("div",{staticClass:"title"},[t("van-image",{attrs:{round:"",fit:"cover",src:e.userInfo.imgPath||a(2752),alt:"图片加载失败"},on:{click:function(s){e.ImageView(e.userInfo.imgPath||a(2752))}}})],1),t("div",{staticClass:"log-out",on:{click:e.logout}},[t("span",{staticClass:"logout-title"},[e._v("退出登录")])])],1)]),t("div",{staticClass:"edit-form"},[t("van-form",{ref:"userDetailForm",attrs:{"show-error":!1,model:e.userInfo}},[t("van-field",{attrs:{readonly:"",name:"username",label:"登录名称"},model:{value:e.userInfo.username,callback:function(s){e.$set(e.userInfo,"username",s)},expression:"userInfo.username"}}),t("van-field",{attrs:{readonly:"",name:"name",label:"用户名称",maxlength:"50"},model:{value:e.userInfo.name,callback:function(s){e.$set(e.userInfo,"name",s)},expression:"userInfo.name"}}),t("van-field",{attrs:{name:"uploader",label:"上传新头像"},scopedSlots:e._u([{key:"input",fn:function(){return[t("van-uploader",{attrs:{"before-read":e.beforeRead,accept:"image/jpeg,image/jpg,image/png",multiple:"","max-count":1},model:{value:e.fileList,callback:function(s){e.fileList=s},expression:"fileList"}})]},proxy:!0}])}),t("van-field",{attrs:{readonly:"",name:"mobile",label:"联系方式",maxlength:"15"},model:{value:e.userInfo.mobile,callback:function(s){e.$set(e.userInfo,"mobile",s)},expression:"userInfo.mobile"}}),t("van-field",{attrs:{readonly:"",name:"email",label:"电子邮件",maxlength:"50"},model:{value:e.userInfo.email,callback:function(s){e.$set(e.userInfo,"email",s)},expression:"userInfo.email"}}),t("van-field",{attrs:{readonly:"",name:"employeeCard",label:"员工卡号"},model:{value:e.userInfo.employeeCard,callback:function(s){e.$set(e.userInfo,"employeeCard",s)},expression:"userInfo.employeeCard"}}),t("van-field",{attrs:{readonly:"",name:"nickname",label:"员工编码"},model:{value:e.userInfo.nickname,callback:function(s){e.$set(e.userInfo,"nickname",s)},expression:"userInfo.nickname"}})],1)],1)],1)},o=[],n=(a(4921),a(2014)),i=a(5197);function r(e){return i.Z.http({url:"/api/cscpUserDetailCustoms/update",method:"put",data:e})}var l={name:"PersonalCenter",data(){return{editPasswordModal:!1,isReadonly:!0,oldPass:"",newPass:"",rePass:"",userInfo:{},fileList:[],editPasswordForm:{oldPass:"",newPass:"",rePass:""},compressionImg:"",value:"",biyiCaptchaKey:""}},methods:{ImageView(e){(0,n.Z)([e])},valideRePassword(e){return e===this.editPasswordForm.newPass||(this.$notify({message:"两次输入密码不一致"}),!1)},logout(){this.$store.commit("user/logout"),window.location.reload()},async beforeRead(e){const s="image/jpeg"===e.type||"image/png"===e.type||"mage/jpg"===e.type;if(!s)return new Promise((e=>(this.$toast({message:"请选择图片格式文件!",forbidClick:!0}),this.compressionImg="",e(new Error(!1)))));this.compressionImg=await this.$util.iosRotateImg(e),this.handleSubmit()},showEditPassword(){this.editPasswordForm={oldPass:"",newPass:"",rePass:""},this.editPasswordModal=!0},cancelButton(){this.editPasswordForm={oldPass:null,newPass:null,rePass:null},this.editPasswordModal=!1},handleSubmit(){this.$toast.loading({forbidClick:!0,duration:0,message:"头像更新中..."});const e=this.compressionImg||this.userInfo.imgPath;r({...this.userInfo,imgPath:e}).then((s=>{this.$toast.clear(),200===s.status?(this.userInfo.imgPath=e,this.$store.commit("user/setUserInfo",this.userInfo),this.$toast.success("更新信息成功")):this.$toast.fail("更新信息失败")})).catch((()=>{this.$toast.clear(),this.$toast.fail("更新信息失败")}))}},created(){this.$store.dispatch("user/GetInfo").then((e=>{200===e.status&&(this.userInfo=e.data)}))}},u=l,m=a(1001),d=(0,m.Z)(u,t,o,!1,null,"3fa68916",null),c=d.exports},4921:function(e,s,a){a(6434),a(6559),a(4199),a(3683),a(6226),a(3103),a(5802),a(4783),a(8409),a(6479)},2752:function(e,s,a){e.exports=a.p+"img/default-touxiang.0f5aba16.png"},879:function(e,s,a){e.exports=a.p+"img/top.c7c5e9fe.png"}}]);
//# sourceMappingURL=599.3122c1b9.js.map