{"version":3,"file":"js/693.edca23a0.js","mappings":"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","sources":["webpack://wisdom_park_pe/./src/components/SecurityCode.vue?a3b3","webpack://wisdom_park_pe/src/components/SecurityCode.vue","webpack://wisdom_park_pe/./src/components/SecurityCode.vue?8fe9","webpack://wisdom_park_pe/./src/components/SecurityCode.vue","webpack://wisdom_park_pe/./src/views/login/login.vue?8ca1","webpack://wisdom_park_pe/src/views/login/login.vue","webpack://wisdom_park_pe/./src/views/login/login.vue?9fce","webpack://wisdom_park_pe/./src/views/login/login.vue"],"sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('van-field',{attrs:{\"name\":\"code\",\"label\":\"验证码\",\"placeholder\":\"请输入验证码\",\"maxlength\":\"8\",\"rules\":[{ required: true, message: '请输入验证码' }]},on:{\"input\":function($event){return _vm.$emit('update:value', _vm.securityCode)}},scopedSlots:_vm._u([{key:\"button\",fn:function(){return [_c('van-image',{staticClass:\"digital-captcha\",attrs:{\"fit\":\"fill\",\"src\":_vm.imgUrl},on:{\"click\":_vm.init}})]},proxy:true}]),model:{value:(_vm.securityCode),callback:function ($$v) {_vm.securityCode=$$v},expression:\"securityCode\"}})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\r\n\r\n  <!-- \r\n  使用方法\r\n  <template>\r\n    <SecurityCode\r\n      :value.sync=\"value\" //输入框的值\r\n      :biyiCaptchaKey.sync=\"biyiCaptchaKey\" //验证码的标识\r\n      ref=\"securityCode\" //用于获取组件实例，用于刷新验证码  this.$refs.securityCode.init()\r\n    />\r\n  <template>\r\n  <script>\r\n  //按需引入\r\n  import SecurityCode from '@/components/SecurityCode.vue'\r\n  export default {\r\n    components: {\r\n      SecurityCode\r\n    }\r\n  }\r\n  </script>\r\n  -->\r\n<template>\r\n  <van-field\r\n    v-model=\"securityCode\"\r\n    @input=\"$emit('update:value', securityCode)\"\r\n    name=\"code\"\r\n    label=\"验证码\"\r\n    placeholder=\"请输入验证码\"\r\n    maxlength=\"8\"\r\n    :rules=\"[{ required: true, message: '请输入验证码' }]\"\r\n  >\r\n    <template #button>\r\n      <van-image\r\n        @click=\"init\"\r\n        class=\"digital-captcha\"\r\n        fit=\"fill\"\r\n        :src=\"imgUrl\"\r\n      />\r\n    </template>\r\n  </van-field>\r\n</template>\r\n\r\n<script>\r\nimport { getDigitalCaptcha } from '@/api/login'\r\nexport default {\r\n  name: 'SecurityCode',\r\n  data() {\r\n    return {\r\n      imgUrl: '',\r\n      securityCode: ''\r\n    }\r\n  },\r\n  props: {\r\n    value: {\r\n      type: String,\r\n      default: ''\r\n    },\r\n    biyiCaptchaKey: {\r\n      type: String,\r\n      default: ''\r\n    }\r\n  },\r\n  methods: {\r\n    init() {\r\n      this.getSecurityCode()\r\n    },\r\n    getSecurityCode() {\r\n      this.securityCode = ''\r\n      //获取验证码\r\n      getDigitalCaptcha()\r\n        .then((res) => {\r\n          if (res) {\r\n            let key = Object.keys(res.data)[0]\r\n            this.imgUrl = res.data[key]\r\n            this.$emit('update:biyiCaptchaKey', Object.keys(res.data)[0])\r\n          }\r\n        })\r\n        .catch()\r\n    }\r\n  },\r\n  created() {\r\n    this.init()\r\n  }\r\n}\r\n</script>\r\n<style lang=\"less\" scoped >\r\n.digital-captcha {\r\n  width: 83px;\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./SecurityCode.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./SecurityCode.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./SecurityCode.vue?vue&type=template&id=2e4a3cd5&scoped=true&\"\nimport script from \"./SecurityCode.vue?vue&type=script&lang=js&\"\nexport * from \"./SecurityCode.vue?vue&type=script&lang=js&\"\nimport style0 from \"./SecurityCode.vue?vue&type=style&index=0&id=2e4a3cd5&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"2e4a3cd5\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"login\"},[_c('img',{attrs:{\"width\":\"100%\",\"fit\":\"fill\",\"src\":require('../../assets/image/login/login-bg.png'),\"alt\":\"图片加载失败\"}}),_c('van-form',{attrs:{\"show-error\":false},on:{\"submit\":_vm.onSubmit}},[_c('van-cell-group',{attrs:{\"inset\":\"\"}},[_c('van-field',{attrs:{\"name\":\"username\",\"label\":\"用户名\",\"placeholder\":\"请输入用户名\",\"maxlength\":\"30\",\"rules\":[{ required: true, message: '请填写用户名' }]},model:{value:(_vm.formItem.username),callback:function ($$v) {_vm.$set(_vm.formItem, \"username\", $$v)},expression:\"formItem.username\"}}),_c('van-field',{attrs:{\"type\":\"password\",\"name\":\"password\",\"label\":\"密码\",\"maxlength\":\"30\",\"placeholder\":\"请输入密码\",\"rules\":[{ required: true, message: '请填写密码' }]},model:{value:(_vm.formItem.password),callback:function ($$v) {_vm.$set(_vm.formItem, \"password\", $$v)},expression:\"formItem.password\"}}),_c('SecurityCode',{ref:\"securityCode\",attrs:{\"value\":_vm.value,\"biyiCaptchaKey\":_vm.biyiCaptchaKey,\"width\":\"100%\"},on:{\"update:value\":function($event){_vm.value=$event},\"update:biyiCaptchaKey\":function($event){_vm.biyiCaptchaKey=$event},\"update:biyi-captcha-key\":function($event){_vm.biyiCaptchaKey=$event}}})],1),_c('div',{staticClass:\"btn-margin\"},[_c('van-button',{attrs:{\"round\":\"\",\"block\":\"\",\"loading\":_vm.loading,\"type\":\"info\",\"loading-text\":\"登录中...\",\"native-type\":\"submit\"}},[_vm._v(\" 提交 \")])],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\r\n\r\n<template>\r\n  <div class=\"login\">\r\n    <img\r\n      width=\"100%\"\r\n      fit=\"fill\"\r\n      :src=\"require('../../assets/image/login/login-bg.png')\"\r\n      alt=\"图片加载失败\"\r\n    />\r\n    <van-form @submit=\"onSubmit\" :show-error=\"false\">\r\n      <van-cell-group inset>\r\n        <van-field\r\n          v-model=\"formItem.username\"\r\n          name=\"username\"\r\n          label=\"用户名\"\r\n          placeholder=\"请输入用户名\"\r\n          maxlength=\"30\"\r\n          :rules=\"[{ required: true, message: '请填写用户名' }]\"\r\n        />\r\n        <van-field\r\n          v-model=\"formItem.password\"\r\n          type=\"password\"\r\n          name=\"password\"\r\n          label=\"密码\"\r\n          maxlength=\"30\"\r\n          placeholder=\"请输入密码\"\r\n          :rules=\"[{ required: true, message: '请填写密码' }]\"\r\n        />\r\n        <SecurityCode\r\n          :value.sync=\"value\"\r\n          :biyiCaptchaKey.sync=\"biyiCaptchaKey\"\r\n          width=\"100%\"\r\n          ref=\"securityCode\"\r\n        />\r\n      </van-cell-group>\r\n      <div class=\"btn-margin\">\r\n        <van-button\r\n          round\r\n          block\r\n          :loading=\"loading\"\r\n          type=\"info\"\r\n          loading-text=\"登录中...\"\r\n          native-type=\"submit\"\r\n        >\r\n          提交\r\n        </van-button>\r\n      </div>\r\n    </van-form>\r\n  </div>\r\n</template>\r\n<script>\r\nimport { login } from '@/api/login'\r\nimport { ACCESS_TOKEN } from '@/config/defaultSettings'\r\nimport SecurityCode from '@/components/SecurityCode.vue'\r\nexport default {\r\n  name: 'Login',\r\n  data() {\r\n    return {\r\n      formItem: {\r\n        username: '',\r\n        password: ''\r\n      },\r\n      code: '',\r\n      loading: false,\r\n      value: '',\r\n      biyiCaptchaKey: ''\r\n    }\r\n  },\r\n  methods: {\r\n    onSubmit() {\r\n      this.loading = true\r\n      login(\r\n        {\r\n          rememberme: '0',\r\n          username: this.formItem.username,\r\n          password: this.formItem.password\r\n        },\r\n        {\r\n          biyiCaptchaKey: this.biyiCaptchaKey,\r\n          biyiCaptcha: JSON.stringify({\r\n            code: this.value\r\n          })\r\n        }\r\n      )\r\n        .then((res) => {\r\n          this.loading = false\r\n          if (res.status == 200) {\r\n            if (res.data.passwordStatus) {\r\n              this.$notify({\r\n                type: 'warning',\r\n                message:\r\n                  res.data.passwordStatus === 1\r\n                    ? '您的密码为初始密码，请修改后再重新登录！'\r\n                    : '密码已使用3个月，请修改后再重新登录！',\r\n                duration: 5000\r\n              })\r\n              this.$router.push({ name: 'updatePswd' })\r\n            } else {\r\n              this.$ls.set(\r\n                //本系统需要的token\r\n                ACCESS_TOKEN,\r\n                res.data.token,\r\n                0.5 * 24 * 60 * 60 * 1000\r\n              )\r\n              this.$ls.set(\r\n                //子系统免登录token\r\n                'access_token',\r\n                res.headers['access-token'],\r\n                0.5 * 24 * 60 * 60 * 1000\r\n              )\r\n              this.$notify({\r\n                type: 'primary',\r\n                message: '登录成功',\r\n                duration: 1000\r\n              })\r\n              this.$router.push({ name: 'home' })\r\n            }\r\n          }\r\n        })\r\n        .catch((error) => {\r\n          this.loading = false\r\n          this.code = ''\r\n          this.$refs.securityCode.init()\r\n          if (error.response) {\r\n            switch (error.response.status) {\r\n              case 401:\r\n                if (error.response.data.attempts) {\r\n                  this.$notify({\r\n                    message: `登录失败，您还有 ${error.response.data.attempts} 尝试机会！`\r\n                  })\r\n                } else {\r\n                  const locktime = this.formatLockedTime(\r\n                    error.response.data.lockoutTime\r\n                  )\r\n                  this.$notify({\r\n                    message: `登录失败，您的账号已被锁定，请在${locktime}后重试！`\r\n                  })\r\n                }\r\n                break\r\n              default:\r\n                this.$notify({\r\n                  message: `登录失败，${error.response.data.message}！`\r\n                })\r\n                break\r\n            }\r\n          }\r\n        })\r\n    },\r\n    formatLockedTime(time) {\r\n      let str = ''\r\n      const d = parseInt(time / (3600 * 24))\r\n      let h = parseInt((time % (3600 * 24)) / 3600)\r\n      let m = parseInt((time % 3600) / 60)\r\n      let s = (time % 3600) % 60\r\n      if (d > 0) {\r\n        str = `${str}${d}天`\r\n      }\r\n      if (h > 0) {\r\n        str = `${str}${h}小时`\r\n      }\r\n      if (m > 0) {\r\n        str = `${str}${m}分`\r\n      }\r\n      if (s > 0) {\r\n        str = `${str}${s}秒`\r\n      }\r\n      return str\r\n    }\r\n  },\r\n  components: {\r\n    SecurityCode\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.login {\r\n  form {\r\n    width: 90%;\r\n    margin: -35px auto 0;\r\n    padding: 10px 0;\r\n    border-radius: 10px;\r\n    position: relative;\r\n    background: white;\r\n  }\r\n  .btn-margin {\r\n    margin: 16px;\r\n    margin-bottom: 5px;\r\n  }\r\n  [class*='van-hairline']::after {\r\n    content: inherit;\r\n  }\r\n}\r\n</style>\r\n\r\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./login.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./login.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./login.vue?vue&type=template&id=5eb56014&scoped=true&\"\nimport script from \"./login.vue?vue&type=script&lang=js&\"\nexport * from \"./login.vue?vue&type=script&lang=js&\"\nimport style0 from \"./login.vue?vue&type=style&index=0&id=5eb56014&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"5eb56014\",\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","required","message","on","$event","$emit","securityCode","scopedSlots","_u","key","fn","staticClass","imgUrl","init","proxy","model","value","callback","$$v","expression","staticRenderFns","name","data","props","type","String","default","biyiCaptchaKey","methods","getSecurityCode","created","component","onSubmit","formItem","$set","ref","loading","_v","username","password","code","formatLockedTime","time","str","d","parseInt","h","m","s","components","SecurityCode"],"sourceRoot":""}