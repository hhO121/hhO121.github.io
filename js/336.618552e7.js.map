{"version":3,"file":"js/336.618552e7.js","mappings":"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","sources":["webpack://wisdom_park_visitor/./src/views/visitor/temporary-visitor/passCertificateTemporary.vue?1a4c","webpack://wisdom_park_visitor/src/views/visitor/temporary-visitor/passCertificateTemporary.vue","webpack://wisdom_park_visitor/./src/views/visitor/temporary-visitor/passCertificateTemporary.vue?9ba8","webpack://wisdom_park_visitor/./src/views/visitor/temporary-visitor/passCertificateTemporary.vue"],"sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"pass-certificate\"},[_c('van-image',{attrs:{\"width\":\"100%\",\"fit\":\"fill\",\"src\":require('../../../assets/image/home/top.png'),\"alt\":\"图片加载失败\"}}),_c('div',{staticClass:\"code-page\"},[_c('div',{staticClass:\"title-info\"},[_c('div',{staticClass:\"invitation-info\"},[_c('div',[_c('van-image',{attrs:{\"round\":\"\",\"fit\":\"cover\",\"src\":require('../../../assets/image/visitor/invitation.png'),\"alt\":\"图片加载失败\"}})],1),_vm._m(0)]),_c('van-divider',{style:({\n          borderColor: 'rgb(210 212 213)'\n        })}),_c('van-field',{staticClass:\"tel-verification\",attrs:{\"colon\":\"\",\"type\":\"tel\",\"maxlength\":\"11\",\"label\":\"手机号码\",\"placeholder\":\"请输入手机号码获得通行凭证\",\"rules\":[{ required: true, message: '请填写访客手机号码' }]},model:{value:(_vm.visitorPhoneNbr),callback:function ($$v) {_vm.visitorPhoneNbr=$$v},expression:\"visitorPhoneNbr\"}})],1),_vm._m(1)]),_c('div',{staticClass:\"footer-btn\"},[_c('van-button',{attrs:{\"block\":\"\",\"round\":\"\",\"type\":\"info\"},on:{\"click\":_vm.handleQuery}},[_vm._v(\" 立即查看 \")])],1)],1)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('span',[_vm._v(\" 欢迎拜访湖北公众信息产业有限责任公司，请填写手机号进行登记。 \")])])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"tips-info\"},[_c('span',[_vm._v(\"  1. 未经许可不得进入限制进入的工作区。 \")]),_c('br'),_c('span',[_vm._v(\"  2. 未经许可不得擅自对工作区域进行拍照或录影。\")]),_c('br'),_c('span',[_vm._v(\"  3. 通行权限失效后，请联系被访人重新获取权限。\")])])}]\n\nexport { render, staticRenderFns }","\r\n\r\n<template>\r\n  <div class=\"pass-certificate\">\r\n    <van-image\r\n      width=\"100%\"\r\n      fit=\"fill\"\r\n      :src=\"require('../../../assets/image/home/top.png')\"\r\n      alt=\"图片加载失败\"\r\n    />\r\n    <div class=\"code-page\">\r\n      <div class=\"title-info\">\r\n        <div class=\"invitation-info\">\r\n          <div>\r\n            <van-image\r\n              round\r\n              fit=\"cover\"\r\n              :src=\"require('../../../assets/image/visitor/invitation.png')\"\r\n              alt=\"图片加载失败\"\r\n            />\r\n          </div>\r\n          <div>\r\n            <span>\r\n              欢迎拜访湖北公众信息产业有限责任公司，请填写手机号进行登记。\r\n            </span>\r\n          </div>\r\n        </div>\r\n        <van-divider\r\n          :style=\"{\r\n            borderColor: 'rgb(210 212 213)'\r\n          }\"\r\n        />\r\n        <!-- 填写手机号码进行验证 -->\r\n        <van-field\r\n          class=\"tel-verification\"\r\n          colon\r\n          v-model=\"visitorPhoneNbr\"\r\n          type=\"tel\"\r\n          maxlength=\"11\"\r\n          label=\"手机号码\"\r\n          placeholder=\"请输入手机号码获得通行凭证\"\r\n          :rules=\"[{ required: true, message: '请填写访客手机号码' }]\"\r\n        />\r\n      </div>\r\n      <div class=\"tips-info\">\r\n        <span>&nbsp;&nbsp;1. 未经许可不得进入限制进入的工作区。 </span>\r\n        <br />\r\n        <span>&nbsp;&nbsp;2. 未经许可不得擅自对工作区域进行拍照或录影。</span>\r\n        <br />\r\n        <span>&nbsp;&nbsp;3. 通行权限失效后，请联系被访人重新获取权限。</span>\r\n      </div>\r\n    </div>\r\n    <div class=\"footer-btn\">\r\n      <van-button @click=\"handleQuery\" block round type=\"info\">\r\n        立即查看\r\n      </van-button>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport vm from '@/main'\r\nimport { qryVisitorInfoDetail } from '@/api/visitor' //获取详情\r\n\r\nimport { mapState } from 'vuex'\r\nexport default {\r\n  name: 'PassCertificateTemporary',\r\n  data() {\r\n    return {\r\n      visitorPhoneNbr: '',\r\n      data: {}\r\n    }\r\n  },\r\n  methods: {\r\n    // 点击立即查看进入通行码\r\n    handleQuery() {\r\n      if (\r\n        /^(13[0-9]|14[01456879]|15[0-35-9]|16[2567]|17[0-8]|18[0-9]|19[0-35-9])\\d{8}$/.test(\r\n          this.visitorPhoneNbr\r\n        )\r\n      ) {\r\n        const params = this.$util.getRouteParams({\r\n          name: 'temporaryVisitorReg'\r\n        }) // 获取的参数\r\n        //没有id则跳去填写\r\n        if (!params.temporaryVisitId) {\r\n          this.$router.push({\r\n            name: 'temporaryVisitorReg',\r\n            params: {\r\n              visitorPhoneNbr: this.visitorPhoneNbr\r\n            }\r\n          })\r\n          return\r\n        }\r\n        this.$toast.loading({\r\n          duration: 0,\r\n          forbidClick: true,\r\n          message: '数据验证中...'\r\n        })\r\n        qryVisitorInfoDetail({\r\n          visitorPhoneNbr: this.visitorPhoneNbr,\r\n          visitorInfoId: params.temporaryVisitId\r\n        }).then((res) => {\r\n          this.$toast.clear()\r\n          if (res.code === 200) {\r\n            const data = res.data.row[0]\r\n            // 是否查询到访客数据，没有则跳转去填写\r\n            if (res.data.row.length === 1) {\r\n              if (\r\n                !this.$util.isDuringDate(data.visitStartTime, data.visitEndTime)\r\n              ) {\r\n                this.$toast({\r\n                  duration: 3000,\r\n                  message: '预约信息已过期，请重新预约'\r\n                })\r\n                this.$router.push({\r\n                  name: 'temporaryVisitorReg',\r\n                  params: {\r\n                    visitorPhoneNbr: this.visitorPhoneNbr\r\n                  }\r\n                })\r\n                return\r\n              }\r\n              switch (data.sts) {\r\n                case 'YYZ':\r\n                  this.$toast({\r\n                    duration: 3000,\r\n                    message: '正在预约中，您可在此页面进行更改'\r\n                  })\r\n                  this.$router.push({\r\n                    name: 'temporaryVisitorReg',\r\n                    params: {\r\n                      visitorPhoneNbr: this.visitorPhoneNbr,\r\n                      temporaryVisitId: data.visitorInfoId\r\n                    }\r\n                  })\r\n                  break\r\n                case 'YYBTY':\r\n                  this.$toast({\r\n                    duration: 3000,\r\n                    message: '预约未通过，请重新输入预约信息'\r\n                  })\r\n                  this.$router.push({\r\n                    name: 'temporaryVisitorReg',\r\n                    params: {\r\n                      visitorPhoneNbr: this.visitorPhoneNbr\r\n                    }\r\n                  })\r\n                  break\r\n                default:\r\n                  this.$router.push({\r\n                    name: 'passCode',\r\n                    params: {\r\n                      visitorPhoneNbr: this.visitorPhoneNbr,\r\n                      visitorInfoId: params.temporaryVisitId,\r\n                      visitorOpenid: this.myUserInfo.openId\r\n                    }\r\n                  })\r\n                  break\r\n              }\r\n            } else {\r\n              this.$router.push({\r\n                name: 'temporaryVisitorReg',\r\n                params: {\r\n                  phoneNbrError: true,\r\n                  temporaryVisitId: params.temporaryVisitId,\r\n                  visitorPhoneNbr: this.visitorPhoneNbr\r\n                }\r\n              })\r\n            }\r\n          } else {\r\n            this.$toast({\r\n              duration: 3000,\r\n              forbidClick: true,\r\n              message: res.msg\r\n            })\r\n          }\r\n        })\r\n      } else {\r\n        this.$toast({\r\n          duration: 3000,\r\n          message: '请输入正确格式的手机号码'\r\n        })\r\n      }\r\n    }\r\n  },\r\n  async beforeRouteEnter(to, from, next) {\r\n    const userInfo = vm.$store.state.user.userInfo\r\n    //是否有参数\r\n    if (userInfo.openId) {\r\n      vm.$toast.loading({\r\n        duration: 0,\r\n        forbidClick: true,\r\n        message: '数据验证中...'\r\n      })\r\n      qryVisitorInfoDetail({\r\n        visitorOpenid: userInfo.openId,\r\n        visitorPhoneNbr: userInfo.phoneNbr\r\n      }).then((res) => {\r\n        vm.$toast.clear()\r\n        if (res.code === 200) {\r\n          const data = res.data.row[res.data.row.length - 1]\r\n          // 是否查询到访客数据，没有则跳转去填写\r\n          if (data) {\r\n            if (\r\n              !vm.$util.isDuringDate(data.visitStartTime, data.visitEndTime)\r\n            ) {\r\n              vm.$toast({\r\n                duration: 3000,\r\n                message: '预约信息已过期，请重新预约'\r\n              })\r\n              next({\r\n                name: 'temporaryVisitorReg',\r\n                params: {\r\n                  visitorPhoneNbr: userInfo.phoneNbr,\r\n                  openId: userInfo.openId\r\n                }\r\n              })\r\n              return\r\n            }\r\n            switch (data.sts) {\r\n              case 'YYZ':\r\n                vm.$toast({\r\n                  duration: 3000,\r\n                  message: '正在预约中，您可在此页面进行更改'\r\n                })\r\n                next({\r\n                  name: 'temporaryVisitorReg',\r\n                  params: {\r\n                    visitorPhoneNbr: userInfo.phoneNbr,\r\n                    temporaryVisitId: data.visitorInfoId,\r\n                    openId: userInfo.openId\r\n                  }\r\n                })\r\n                break\r\n              case 'YYBTY':\r\n                vm.$toast({\r\n                  duration: 3000,\r\n                  message: '预约未通过，请重新输入预约信息'\r\n                })\r\n                next({\r\n                  name: 'temporaryVisitorReg',\r\n                  params: {\r\n                    visitorPhoneNbr: userInfo.phoneNbr,\r\n                    openId: userInfo.openId\r\n                  }\r\n                })\r\n                break\r\n              default:\r\n                next({\r\n                  name: 'passCode',\r\n                  params: {\r\n                    visitorPhoneNbr: userInfo.phoneNbr,\r\n                    visitorInfoId: data.visitorInfoId,\r\n                    visitorOpenid: userInfo.openId\r\n                  }\r\n                })\r\n                break\r\n            }\r\n          } else {\r\n            next({\r\n              name: 'temporaryVisitorReg',\r\n              params: {\r\n                visitorPhoneNbr: userInfo.phoneNbr,\r\n                openId: userInfo.openId\r\n              }\r\n            })\r\n          }\r\n        } else {\r\n          vm.$toast({\r\n            duration: 3000,\r\n            forbidClick: true,\r\n            message: res.msg\r\n          })\r\n        }\r\n      })\r\n    } else {\r\n      next()\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapState({\r\n      myUserInfo: (state) => state.user.userInfo, // 用户信息\r\n      unitId: (state) => state.user.unitId\r\n    })\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" >\r\n.pass-certificate {\r\n  .code-page {\r\n    position: relative;\r\n    background: #ffffff;\r\n    box-shadow: 0 0 10px -7px #cac7c7;\r\n    border-radius: 5px;\r\n    margin: -70px 10px 20px;\r\n    padding: 20px 13px 20px;\r\n    height: 67vh;\r\n    display: flex;\r\n    flex-direction: column;\r\n    justify-content: space-between;\r\n    .title-info {\r\n      .tel-verification {\r\n        display: flex;\r\n        align-items: center;\r\n        padding: 10px 14px;\r\n        div.van-cell__title {\r\n          width: 60px;\r\n        }\r\n        div.van-cell__value {\r\n          border: 1px solid #d1cece99;\r\n          border-radius: 4px;\r\n          padding: 7px;\r\n        }\r\n      }\r\n      .invitation-info {\r\n        font-size: 14.3px;\r\n        line-height: 29px;\r\n        margin-bottom: 10px;\r\n        display: flex;\r\n        align-items: center;\r\n        color: #545454;\r\n        > div:first-child {\r\n          .van-image {\r\n            width: 60px;\r\n            height: 60px;\r\n          }\r\n          & + div {\r\n            padding: 0 10px;\r\n          }\r\n        }\r\n      }\r\n    }\r\n    .tips-info {\r\n      font-size: 11px;\r\n      line-height: 30px;\r\n      letter-spacing: 2px;\r\n      color: #a7a5a5;\r\n      span {\r\n        display: inline-block;\r\n      }\r\n    }\r\n  }\r\n  .footer-btn {\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n    height: 60px;\r\n    .van-button {\r\n      margin: 16px 24px 22px;\r\n    }\r\n  }\r\n}\r\n</style>\r\n\r\n","import mod from \"-!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./passCertificateTemporary.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./passCertificateTemporary.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./passCertificateTemporary.vue?vue&type=template&id=5bd99486&\"\nimport script from \"./passCertificateTemporary.vue?vue&type=script&lang=js&\"\nexport * from \"./passCertificateTemporary.vue?vue&type=script&lang=js&\"\nimport style0 from \"./passCertificateTemporary.vue?vue&type=style&index=0&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","_m","style","borderColor","required","message","model","value","callback","$$v","visitorPhoneNbr","expression","on","handleQuery","_v","staticRenderFns","name","data","methods","params","temporaryVisitId","$router","push","$toast","loading","duration","forbidClick","visitorInfoId","res","code","row","length","sts","visitorOpenid","phoneNbrError","msg","computed","component"],"sourceRoot":""}