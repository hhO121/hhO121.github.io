{"version":3,"file":"js/300.65565574.js","mappings":"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","sources":["webpack://wisdom_park_visitor/./src/views/visitor/vip-appointment/passCertificate.vue?c5bf","webpack://wisdom_park_visitor/./src/views/visitor/vip-appointment/passCertificate.vue?e364","webpack://wisdom_park_visitor/./src/views/visitor/vip-appointment/passCertificate.vue","webpack://wisdom_park_visitor/./node_modules/core-js/internals/correct-is-regexp-logic.js","webpack://wisdom_park_visitor/./node_modules/core-js/internals/not-a-regexp.js","webpack://wisdom_park_visitor/./node_modules/core-js/modules/es.array.map.js","webpack://wisdom_park_visitor/./node_modules/core-js/modules/es.string.includes.js","webpack://wisdom_park_visitor/src/views/visitor/vip-appointment/passCertificate.vue"],"sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"pass-certificate\"},[_c('van-image',{attrs:{\"width\":\"100%\",\"fit\":\"fill\",\"src\":require('../../../assets/image/home/top.png'),\"alt\":\"图片加载失败\"}}),_c('div',{staticClass:\"code-page\"},[_c('div',{staticClass:\"title-info\"},[_c('div',{staticClass:\"invitation-info\"},[_c('div',[_c('van-image',{attrs:{\"round\":\"\",\"fit\":\"cover\",\"src\":require('../../../assets/image/visitor/invitation.png'),\"alt\":\"图片加载失败\"}})],1),_c('div',[_vm._v(\" 湖北公众信息产业有限责任公司【\"+_vm._s(_vm.data.name)+\"】邀请您，于 \"+_vm._s(_vm.data.visitStartTime1)+\" 至 \"+_vm._s(_vm.data.visitEndTime1)+\" 到我司\"+_vm._s(_vm.data.visitorReason)+\" \")])]),_c('van-divider',{style:({\n          borderColor: 'rgb(210 212 213)'\n        })}),_c('van-field',{staticClass:\"tel-verification\",attrs:{\"required\":\"\",\"colon\":\"\",\"type\":\"tel\",\"maxlength\":\"11\",\"label\":\"手机号码\",\"placeholder\":\"请输入手机号码进行验证\"},model:{value:(_vm.visitorPhoneNbr),callback:function ($$v) {_vm.visitorPhoneNbr=$$v},expression:\"visitorPhoneNbr\"}})],1),_vm._m(0)]),_c('div',{staticClass:\"footer-btn\"},[_c('van-button',{attrs:{\"block\":\"\",\"round\":\"\",\"type\":\"info\"},on:{\"click\":_vm.handleQuery}},[_vm._v(\" 立即查看 \")])],1)],1)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"tips-info\"},[_c('span',[_vm._v(\"  1. 未经许可不得进入限制进入的工作区。 \")]),_c('br'),_c('span',[_vm._v(\"  2. 未经许可不得擅自对工作区域进行拍照或录影。\")]),_c('br'),_c('span',[_vm._v(\"  3. 通行权限失效后，请联系被访人重新获取权限。\")])])}]\n\nexport { render, staticRenderFns }","import mod from \"-!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./passCertificate.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].rules[0].use[0]!../../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./passCertificate.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./passCertificate.vue?vue&type=template&id=87c84340&\"\nimport script from \"./passCertificate.vue?vue&type=script&lang=js&\"\nexport * from \"./passCertificate.vue?vue&type=script&lang=js&\"\nimport style0 from \"./passCertificate.vue?vue&type=style&index=0&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar MATCH = wellKnownSymbol('match');\n\nmodule.exports = function (METHOD_NAME) {\n  var regexp = /./;\n  try {\n    '/./'[METHOD_NAME](regexp);\n  } catch (error1) {\n    try {\n      regexp[MATCH] = false;\n      return '/./'[METHOD_NAME](regexp);\n    } catch (error2) { /* empty */ }\n  } return false;\n};\n","var global = require('../internals/global');\nvar isRegExp = require('../internals/is-regexp');\n\nvar TypeError = global.TypeError;\n\nmodule.exports = function (it) {\n  if (isRegExp(it)) {\n    throw TypeError(\"The method doesn't accept regular expressions\");\n  } return it;\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar $map = require('../internals/array-iteration').map;\nvar arrayMethodHasSpeciesSupport = require('../internals/array-method-has-species-support');\n\nvar HAS_SPECIES_SUPPORT = arrayMethodHasSpeciesSupport('map');\n\n// `Array.prototype.map` method\n// https://tc39.es/ecma262/#sec-array.prototype.map\n// with adding support of @@species\n$({ target: 'Array', proto: true, forced: !HAS_SPECIES_SUPPORT }, {\n  map: function map(callbackfn /* , thisArg */) {\n    return $map(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar notARegExp = require('../internals/not-a-regexp');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar toString = require('../internals/to-string');\nvar correctIsRegExpLogic = require('../internals/correct-is-regexp-logic');\n\nvar stringIndexOf = uncurryThis(''.indexOf);\n\n// `String.prototype.includes` method\n// https://tc39.es/ecma262/#sec-string.prototype.includes\n$({ target: 'String', proto: true, forced: !correctIsRegExpLogic('includes') }, {\n  includes: function includes(searchString /* , position = 0 */) {\n    return !!~stringIndexOf(\n      toString(requireObjectCoercible(this)),\n      toString(notARegExp(searchString)),\n      arguments.length > 1 ? arguments[1] : undefined\n    );\n  }\n});\n","\r\n\r\n<template>\r\n  <div class=\"pass-certificate\">\r\n    <van-image\r\n      width=\"100%\"\r\n      fit=\"fill\"\r\n      :src=\"require('../../../assets/image/home/top.png')\"\r\n      alt=\"图片加载失败\"\r\n    />\r\n    <div class=\"code-page\">\r\n      <div class=\"title-info\">\r\n        <div class=\"invitation-info\">\r\n          <div>\r\n            <van-image\r\n              round\r\n              fit=\"cover\"\r\n              :src=\"require('../../../assets/image/visitor/invitation.png')\"\r\n              alt=\"图片加载失败\"\r\n            />\r\n          </div>\r\n          <div>\r\n            <!-- 暂时写死 -->\r\n            湖北公众信息产业有限责任公司【{{ data.name }}】邀请您，于\r\n            {{ data.visitStartTime1 }} 至 {{ data.visitEndTime1 }} 到我司{{\r\n              data.visitorReason\r\n            }}\r\n          </div>\r\n        </div>\r\n        <van-divider\r\n          :style=\"{\r\n            borderColor: 'rgb(210 212 213)'\r\n          }\"\r\n        />\r\n        <!-- 填写手机号码进行验证 -->\r\n        <van-field\r\n          class=\"tel-verification\"\r\n          required\r\n          colon\r\n          v-model=\"visitorPhoneNbr\"\r\n          type=\"tel\"\r\n          maxlength=\"11\"\r\n          label=\"手机号码\"\r\n          placeholder=\"请输入手机号码进行验证\"\r\n        />\r\n      </div>\r\n      <div class=\"tips-info\">\r\n        <span>&nbsp;&nbsp;1. 未经许可不得进入限制进入的工作区。 </span>\r\n        <br />\r\n        <span>&nbsp;&nbsp;2. 未经许可不得擅自对工作区域进行拍照或录影。</span>\r\n        <br />\r\n        <span>&nbsp;&nbsp;3. 通行权限失效后，请联系被访人重新获取权限。</span>\r\n      </div>\r\n    </div>\r\n    <div class=\"footer-btn\">\r\n      <van-button @click=\"handleQuery\" block round type=\"info\">\r\n        立即查看\r\n      </van-button>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport vm from '@/main'\r\nimport { qryVisitorInfo } from '@/api/visitor' // 验证链接是否有效，验证手机号码\r\nexport default {\r\n  name: 'PassCertificate',\r\n  data() {\r\n    return {\r\n      visitorPhoneNbr: '',\r\n      data: {}\r\n    }\r\n  },\r\n  methods: {\r\n    // 点击立即查看进入通行码\r\n    handleQuery() {\r\n      // 判断链接是否在有效期内\r\n      if (\r\n        !this.$util.isDuringDate(\r\n          this.data.visitStartTime,\r\n          this.data.visitEndTime\r\n        )\r\n      ) {\r\n        this.$toast.fail({\r\n          message: '链接已过期',\r\n          duration: 3000,\r\n          forbidClick: true\r\n        })\r\n        return\r\n      }\r\n      const test =\r\n        /^(13[0-9]|14[01456879]|15[0-35-9]|16[2567]|17[0-8]|18[0-9]|19[0-35-9])\\d{8}$/\r\n      // 手机格式\r\n      if (!test.test(this.visitorPhoneNbr)) {\r\n        this.$toast({\r\n          duration: 3000,\r\n          message: '请输入正确格式的手机号码'\r\n        })\r\n        return\r\n      }\r\n      //验证填写的号码是否跟访客信息相同\r\n      if (this.data.visitorPhoneNbrList.includes(this.visitorPhoneNbr)) {\r\n        this.$router.push({\r\n          name: 'passCode',\r\n          params: {\r\n            visitorInfoId: this.data.visitorInfoId,\r\n            visitorPhoneNbr: this.visitorPhoneNbr\r\n          }\r\n        })\r\n      } else {\r\n        this.$toast({\r\n          duration: 3000,\r\n          message: '手机号码输入错误'\r\n        })\r\n      }\r\n    }\r\n  },\r\n  async beforeRouteEnter(to, form, next) {\r\n    //控制是否跳转二维码\r\n    const key = to.query.key\r\n    //是否有参数\r\n    if (key) {\r\n      // 通过访问id来判断链接是否在有效期内\r\n      let res = await qryVisitorInfo({ token: key.replace(/ /g, '+') })\r\n      if (res.code === 200) {\r\n        const data = res.data.row[res.data.row.length - 1]\r\n        // 判断链接是否在有效期内\r\n        if (\r\n          !data ||\r\n          !vm.$util.isDuringDate(data.visitStartTime, data.visitEndTime)\r\n        ) {\r\n          vm.$toast.fail({\r\n            message: '链接已失效',\r\n            duration: 0,\r\n            forbidClick: true\r\n          })\r\n          return\r\n        }\r\n        const visitorPhoneNbrList = eval('(' + data.visitorPersonArr + ')').map(\r\n          (item) => item.visitorPhoneNbr\r\n        )\r\n        const passCodeParams = vm.$util.getRouteParams({ name: 'passCode' }) // 获取的参数\r\n        //验证储存的号码是否跟访客信息相同\r\n        if (visitorPhoneNbrList.includes(passCodeParams.visitorPhoneNbr)) {\r\n          // 跳转二维码\r\n          next({\r\n            name: 'passCode',\r\n            params: {\r\n              ...passCodeParams,\r\n              visitorInfoId: data.visitorInfoId\r\n            }\r\n          })\r\n        } else {\r\n          next((vm1) => {\r\n            vm1.data = {\r\n              ...data,\r\n              visitorPhoneNbrList,\r\n              visitStartTime1: vm1.$util.format(\r\n                new Date(data.visitStartTime.replace(/-/g, '/')),\r\n                'yyyy年MM月dd日hh时mm分'\r\n              ),\r\n              visitEndTime1: vm1.$util.format(\r\n                new Date(data.visitEndTime.replace(/-/g, '/')),\r\n                'yyyy年MM月dd日hh时mm分'\r\n              )\r\n            }\r\n          })\r\n        }\r\n      } else {\r\n        vm.$toast.fail({\r\n          message: res.msg,\r\n          duration: 0,\r\n          forbidClick: true\r\n        })\r\n      }\r\n    } else {\r\n      next('/404')\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" >\r\n.pass-certificate {\r\n  .code-page {\r\n    position: relative;\r\n    background: #ffffff;\r\n    box-shadow: 0 0 10px -7px #cac7c7;\r\n    border-radius: 5px;\r\n    margin: -70px 10px 20px;\r\n    padding: 20px 13px 20px;\r\n    height: 67vh;\r\n    display: flex;\r\n    flex-direction: column;\r\n    justify-content: space-between;\r\n    .title-info {\r\n      .tel-verification {\r\n        display: flex;\r\n        align-items: center;\r\n        padding: 10px 14px;\r\n        div.van-cell__title {\r\n          width: 60px;\r\n        }\r\n        div.van-cell__value {\r\n          border: 1px solid #d1cece99;\r\n          border-radius: 4px;\r\n          padding: 7px;\r\n        }\r\n      }\r\n      .invitation-info {\r\n        font-size: 14.3px;\r\n        line-height: 29px;\r\n        margin-bottom: 10px;\r\n        display: flex;\r\n        align-items: center;\r\n        color: #545454;\r\n        > div:first-child {\r\n          .van-image {\r\n            width: 60px;\r\n            height: 60px;\r\n          }\r\n          & + div {\r\n            word-break: break-all;\r\n            padding: 0 10px;\r\n          }\r\n        }\r\n      }\r\n    }\r\n    .tips-info {\r\n      font-size: 11px;\r\n      line-height: 30px;\r\n      letter-spacing: 2px;\r\n      color: #a7a5a5;\r\n      span {\r\n        display: inline-block;\r\n      }\r\n    }\r\n  }\r\n  .footer-btn {\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n    height: 60px;\r\n    .van-button {\r\n      margin: 16px 24px 22px;\r\n    }\r\n  }\r\n  .footer-placeholder {\r\n    height: 60px;\r\n  }\r\n}\r\n</style>\r\n\r\n"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","_v","_s","data","name","visitStartTime1","visitEndTime1","visitorReason","style","borderColor","model","value","callback","$$v","visitorPhoneNbr","expression","_m","on","handleQuery","staticRenderFns","component","wellKnownSymbol","MATCH","module","exports","METHOD_NAME","regexp","error1","error2","global","isRegExp","TypeError","it","$","$map","arrayMethodHasSpeciesSupport","HAS_SPECIES_SUPPORT","target","proto","forced","map","callbackfn","arguments","length","undefined","uncurryThis","notARegExp","requireObjectCoercible","toString","correctIsRegExpLogic","stringIndexOf","indexOf","includes","searchString","methods","test","visitorPhoneNbrList","$router","push","params","visitorInfoId","$toast","duration","message","fail","forbidClick"],"sourceRoot":""}