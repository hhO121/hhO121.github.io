"use strict";(self["webpackChunkwisdom_park_pe"]=self["webpackChunkwisdom_park_pe"]||[]).push([[693],{6364:function(e,t,a){a.d(t,{Z:function(){return d}});var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("van-field",{attrs:{name:"code",label:"验证码",placeholder:"请输入验证码",maxlength:"8",rules:[{required:!0,message:"请输入验证码"}]},on:{input:function(t){return e.$emit("update:value",e.securityCode)}},scopedSlots:e._u([{key:"button",fn:function(){return[a("van-image",{staticClass:"digital-captcha",attrs:{fit:"fill",src:e.imgUrl},on:{click:e.init}})]},proxy:!0}]),model:{value:e.securityCode,callback:function(t){e.securityCode=t},expression:"securityCode"}})},s=[],i=(a(7941),a(9106)),o={name:"SecurityCode",data:function(){return{imgUrl:"",securityCode:""}},props:{value:{type:String,default:""},biyiCaptchaKey:{type:String,default:""}},methods:{init:function(){this.getSecurityCode()},getSecurityCode:function(){var e=this;this.securityCode="",(0,i.dM)().then((function(t){if(t){var a=Object.keys(t.data)[0];e.imgUrl=t.data[a],e.$emit("update:biyiCaptchaKey",Object.keys(t.data)[0])}})).catch()}},created:function(){this.init()}},r=o,c=a(1001),u=(0,c.Z)(r,n,s,!1,null,"2e4a3cd5",null),d=u.exports},4693:function(e,t,a){a.r(t),a.d(t,{default:function(){return m}});var n=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"login"},[n("img",{attrs:{width:"100%",fit:"fill",src:a(9722),alt:"图片加载失败"}}),n("van-form",{attrs:{"show-error":!1},on:{submit:e.onSubmit}},[n("van-cell-group",{attrs:{inset:""}},[n("van-field",{attrs:{name:"username",label:"用户名",placeholder:"请输入用户名",maxlength:"30",rules:[{required:!0,message:"请填写用户名"}]},model:{value:e.formItem.username,callback:function(t){e.$set(e.formItem,"username",t)},expression:"formItem.username"}}),n("van-field",{attrs:{type:"password",name:"password",label:"密码",maxlength:"30",placeholder:"请输入密码",rules:[{required:!0,message:"请填写密码"}]},model:{value:e.formItem.password,callback:function(t){e.$set(e.formItem,"password",t)},expression:"formItem.password"}}),n("SecurityCode",{ref:"securityCode",attrs:{value:e.value,biyiCaptchaKey:e.biyiCaptchaKey,width:"100%"},on:{"update:value":function(t){e.value=t},"update:biyiCaptchaKey":function(t){e.biyiCaptchaKey=t},"update:biyi-captcha-key":function(t){e.biyiCaptchaKey=t}}})],1),n("div",{staticClass:"btn-margin"},[n("van-button",{attrs:{round:"",block:"",loading:e.loading,type:"info","loading-text":"登录中...","native-type":"submit"}},[e._v(" 提交 ")])],1)],1)],1)},s=[],i=(a(8862),a(2222),a(9106)),o=a(7810),r=a(6364),c={name:"Login",data:function(){return{formItem:{username:"",password:""},code:"",loading:!1,value:"",biyiCaptchaKey:""}},methods:{onSubmit:function(){var e=this;this.loading=!0,(0,i.x4)({rememberme:"0",username:this.formItem.username,password:this.formItem.password},{biyiCaptchaKey:this.biyiCaptchaKey,biyiCaptcha:JSON.stringify({code:this.value})}).then((function(t){e.loading=!1,200==t.status&&(t.data.passwordStatus?(e.$notify({type:"warning",message:1===t.data.passwordStatus?"您的密码为初始密码，请修改后再重新登录！":"密码已使用3个月，请修改后再重新登录！",duration:5e3}),e.$router.push({name:"updatePswd"})):(e.$ls.set(o.L,t.data.token,432e5),e.$ls.set("access_token",t.headers["access-token"],432e5),e.$notify({type:"primary",message:"登录成功",duration:1e3}),e.$router.push({name:"home"})))})).catch((function(t){if(e.loading=!1,e.code="",e.$refs.securityCode.init(),t.response)switch(t.response.status){case 401:if(t.response.data.attempts)e.$notify({message:"登录失败，您还有 ".concat(t.response.data.attempts," 尝试机会！")});else{var a=e.formatLockedTime(t.response.data.lockoutTime);e.$notify({message:"登录失败，您的账号已被锁定，请在".concat(a,"后重试！")})}break;default:e.$notify({message:"登录失败，".concat(t.response.data.message,"！")});break}}))},formatLockedTime:function(e){var t="",a=parseInt(e/86400),n=parseInt(e%86400/3600),s=parseInt(e%3600/60),i=e%3600%60;return a>0&&(t="".concat(t).concat(a,"天")),n>0&&(t="".concat(t).concat(n,"小时")),s>0&&(t="".concat(t).concat(s,"分")),i>0&&(t="".concat(t).concat(i,"秒")),t}},components:{SecurityCode:r.Z}},u=c,d=a(1001),l=(0,d.Z)(u,n,s,!1,null,"5eb56014",null),m=l.exports},9722:function(e,t,a){e.exports=a.p+"img/login-bg.4f6f605b.png"}}]);
//# sourceMappingURL=693-legacy.17afa57b.js.map